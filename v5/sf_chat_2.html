<!DOCTYPE html>
<html>
<head>
    <title>Heap Test</title>
    <style type="text/css">
        h1.main {
            font-size: 64px;
        }

        div.btn {
            font-size: 22px;
            padding: 4px;
            margin: 10px;
            border: 1px solid black;
            width: 120px;
            background-color: ghostWhite;
        }

        div.btn:hover {
            cursor: pointer;
            background-color: #f1f1f1;
        }

        div.error {
            background-color: red;
        }
        div.error:hover {
            background-color: #EA0000;
        }
    </style>
    <!-- Include Heap -->
    <script type="text/javascript">
        // We want to test the old snippet here (which sets window._heapid), to ensure heap.js is backwards-compatible.
        // This old snippet has been mutilated a bit to not have an http/https switch
        window.heapReadyCb=window.heapReadyCb||[],window.heap=window.heap||[],heap.load=function(e,t){window.heap.envId=e,window.heap.clientConfig=t=t||{},window.heap.clientConfig.shouldFetchServerConfig=!1;var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="https://cdn.us.heap-api.com/config/"+e+"/heap_config.js";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(a,r);var n=["init","startTracking","stopTracking","track","resetIdentity","identify","getSessionId","getUserId","getIdentity","addUserProperties","addEventProperties","removeEventProperty","clearEventProperties","addAccountProperties","addAdapter","addTransformer","addTransformerFn","onReady",],i=function(e){return function(){var t=Array.prototype.slice.call(arguments,0);window.heapReadyCb.push({name:e,fn:function(){heap[e]&&heap[e].apply(heap,t)}})}};for(let o=0;o<n.length;o++)heap[n[o]]=i(n[o])};
        heap.load('1028628221', {
            logLevel: 'trace',
            salesforceAura: true
        });
    </script>

<!--    Include Salesforce chat-->
    <style type='text/css'>
        .embeddedServiceHelpButton .helpButton .uiButton {
            background-color: #005290;
            font-family: "Arial", sans-serif;
        }
        .embeddedServiceHelpButton .helpButton .uiButton:focus {
            outline: 1px solid #005290;
        }
    </style>

    <script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script>
    <script type='text/javascript'>
        var initESW = function(gslbBaseURL) {
            embedded_svc.settings.displayHelpButton = true; //Or false
            embedded_svc.settings.language = ''; //For example, enter 'en' or 'en-US'

            //embedded_svc.settings.defaultMinimizedText = '...'; //(Defaults to Chat with an Expert)
            //embedded_svc.settings.disabledMinimizedText = '...'; //(Defaults to Agent Offline)

            //embedded_svc.settings.loadingText = ''; //(Defaults to Loading)
            //embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)

            // Settings for Chat
            //embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
            // Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
            // Returns a valid button ID.
            //};
            //embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
            //embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId
            //embedded_svc.settings.offlineSupportMinimizedText = '...'; //(Defaults to Contact Us)

            embedded_svc.settings.enabledFeatures = ['LiveAgent'];
            embedded_svc.settings.entryFeature = 'LiveAgent';

            embedded_svc.init(
                'https://heap-dev-ed.develop.my.salesforce.com',
                'https://heap-dev-ed.develop.my.salesforce-sites.com/liveAgentSetupFlow',
                gslbBaseURL,
                '00DDn000002oks4',
                'Group',
                {
                    baseLiveAgentContentURL: 'https://c.la1-c1-ia7.salesforceliveagent.com/content',
                    deploymentId: '572Dn0000010wSf',
                    buttonId: '573Dn0000010wT9',
                    baseLiveAgentURL: 'https://d.la1-c1-ia7.salesforceliveagent.com/chat',
                    eswLiveAgentDevName: 'Group',
                    isOfflineSupportEnabled: false
                }
            );
        };

        if (!window.embedded_svc) {
            var s = document.createElement('script');
            s.setAttribute('src', 'https://heap-dev-ed.develop.my.salesforce.com/embeddedservice/5.0/esw.min.js');
            s.onload = function() {
                initESW(null);
            };
            document.body.appendChild(s);
        } else {
            initESW('https://service.force.com');
        }
    </script>
</head>
<body id="page2">
<h2 id="header">This is Page 2 of Heap!</h2>
<div id="clickme">Click Me</div>
<iframe name="iframe" id="iframe" src="/iframe.html" width="400" height="300">
    <p>Your browser does not support iframes.</p>
</iframe>
<div id="errDisp">
    errors<br />
</div>

<script>
    createLink = function(relativePath, id, text, suffix) {
        var href = window.location.href.replace('page2', relativePath) + suffix;
        var anchor = document.createElement('a');
        anchor.href = href;
        anchor.id = id;
        anchor.innerHTML = text;
        document.body.appendChild(anchor);
    };

    createLinks = function(links) {
        for (var i in links) {
            if (!links.hasOwnProperty(i)) {
                continue;
            }
            var link = links[i];
            createLink(link[0], link[1], link[2], link[3]);
        }
    };

    var links = [
        ['page1', 'link2', 'Check out another page', ''],
        ['page1', 'page1_qs', 'Page 1 with query string', '?q=testing'],
        ['page1_without_load', 'page1_without_load', 'Check out another page', ''],
        ['page1_without_load', 'page1_without_load_qs', 'Page 1 with query string', '?q=testing'],
    ];

    createLinks(links);
</script>
</body>
</html>
